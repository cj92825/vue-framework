(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-664b3c76"],{"0187":function(t,e,i){"use strict";i.d(e,"d",function(){return r}),i.d(e,"b",function(){return a}),i.d(e,"a",function(){return s}),i.d(e,"c",function(){return o}),i.d(e,"e",function(){return c});var n=i("b775");function r(t){return Object(n["a"])({url:"/sys/roles",method:"get",params:t})}function a(t){return Object(n["a"])({url:"/sys/editRole",method:"post",data:t})}function s(t){return Object(n["a"])({url:"/sys/deleteRole",method:"post",data:t})}function o(t){return Object(n["a"])({url:"/sys/getPermissionByRoleId",method:"get",params:{roleId:t}})}function c(t,e,i){return Object(n["a"])({url:"/sys/grantPermissions",method:"post",data:{roleId:t,addPermissionIds:e,deletePermissionIds:i}})}},"26f3":function(t,e,i){"use strict";var n=i("d684"),r=i.n(n);r.a},"42df":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("el-row",{staticStyle:{width:"100%"}},[i("el-col",{attrs:{span:7}},[i("el-card",{attrs:{shadow:"hover"}},[i("div",{attrs:{slot:"header"},slot:"header"},[i("span",[t._v("\n            当前选择角色：\n            "),i("label",[t._v(t._s(t.roleName))])])]),t._v(" "),i("el-scrollbar",[i("el-tree",{directives:[{name:"loading",rawName:"v-loading.body",value:t.loading,expression:"loading",modifiers:{body:!0}}],ref:"tree",staticStyle:{height:"320px"},attrs:{data:t.treeData,"default-expand-all":"","node-key":"id","highlight-current":"","expand-on-click-node":!1},on:{"node-click":t.handleNodeClick}})],1)],1)],1),t._v(" "),i("el-col",{attrs:{span:17}},[i("el-card",{attrs:{shadow:"hover"}},[i("div",{attrs:{slot:"header"},slot:"header"},[i("el-button",{attrs:{type:"primary"},on:{click:t.grantPermission}},[t._v("保存")])],1),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:t.filterPermissionData,"max-height":"650px",border:"",fit:"","header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"},"highlight-current-row":""},on:{"selection-change":t.selectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"50"}}),t._v(" "),i("el-table-column",{attrs:{label:"请求地址","min-width":"120",prop:"uri"}}),t._v(" "),i("el-table-column",{attrs:{label:"资源名","min-width":"80",prop:"name"}}),t._v(" "),i("el-table-column",{attrs:{label:"描述","min-width":"120",prop:"description"}})],1)],1)],1)],1)],1)},r=[],a=(i("ac6a"),i("c5f6"),i("e37e")),s=i("0187"),o={data:function(){return{treeData:[],permissionData:[],filterPermissionData:[],loading:!1,waitPermissionData:!1,waitRolePermission:!1,waitGrant:!1,currentGroupId:1,existPermission:[],selectedPermission:[]}},created:function(){this.getGroup(),this.getPermissionData()},computed:{listLoading:function(){return this.waitPermissionData||this.waitRolePermission||this.waitGrant}},props:{roleId:Number,roleName:String},watch:{roleId:function(t,e){t&&(this.currentGroupId=1,this.loadPermissionByRoleId())}},methods:{getGroup:function(){var t=this;this.loading=!0,Object(a["d"])().then(function(e){var i=e.data.data;t.formatTree(i),t.loading=!1}).catch()},getPermissionData:function(){var t=this,e={currentPage:1,size:100};this.waitPermissionData=!0,Object(a["c"])(e).then(function(e){var i=e.data.data.records;t.permissionData=i,t.waitPermissionData=!1,t.filterTableData()}).catch()},formatTree:function(t){var e=this;t.forEach(function(i){0==i.parentId?e.treeData.push(i):t.forEach(function(t){t.id==i.parentId&&(t.children||(t.children=[]),t.children.push(i))})})},handleNodeClick:function(t){this.currentGroupId=t.id,this.filterTableData()},filterTableData:function(){var t=this;this.filterPermissionData=this.permissionData.filter(function(e){return 1==t.currentGroupId||e.groupId==t.currentGroupId}),this.authoritiedFunc()},loadPermissionByRoleId:function(){var t=this;this.waitRolePermission=!0,Object(s["c"])(this.roleId).then(function(e){var i=e.data.data;t.existPermission=i,t.waitRolePermission=!1,t.authoritiedFunc()})},authoritiedFunc:function(){var t=this;this.waitRolePermission||this.waitPermissionData||this.$nextTick(function(){var e=[];t.toggleSelection(e),t.filterPermissionData.forEach(function(i){var n=t.existPermission.some(function(t){return t.permissionId==i.id});n&&e.push(i)}),t.toggleSelection(e)})},toggleSelection:function(t){var e=this;t&&t.length?t.forEach(function(t){e.$refs.table.toggleRowSelection(t)}):this.$refs.table.clearSelection()},selectionChange:function(t){this.selectedPermission=JSON.parse(JSON.stringify(t))},grantPermission:function(){var t=this,e=[],i=[],n={};this.existPermission.forEach(function(t){n[t.permissionId]=1});var r={};this.selectedPermission.forEach(function(t){r[t.id]=1,n[t.id]||e.push(t.id)}),this.existPermission.forEach(function(t){r[t.permissionId]||i.push(t.id)}),this.waitGrant=!0,Object(s["e"])(this.roleId,e,i).then(function(e){t.$notify({title:"成功",message:"授权成功",type:"success",duration:2e3}),t.waitGrant=!1,t.loadPermissionByRoleId()}).catch(function(e){t.$notify({title:"失败",message:"授权成功",type:"error"}),t.listLoading=!1})}}},c=o,l=(i("26f3"),i("2877")),u=Object(l["a"])(c,n,r,!1,null,"30df6857",null);e["default"]=u.exports},aa77:function(t,e,i){var n=i("5ca1"),r=i("be13"),a=i("79e5"),s=i("fdef"),o="["+s+"]",c="​",l=RegExp("^"+o+o+"*"),u=RegExp(o+o+"*$"),d=function(t,e,i){var r={},o=a(function(){return!!s[t]()||c[t]()!=c}),l=r[t]=o?e(f):s[t];i&&(r[i]=l),n(n.P+n.F*o,"String",r)},f=d.trim=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(u,"")),t};t.exports=d},c5f6:function(t,e,i){"use strict";var n=i("7726"),r=i("69a8"),a=i("2d95"),s=i("5dbc"),o=i("6a99"),c=i("79e5"),l=i("9093").f,u=i("11e9").f,d=i("86cc").f,f=i("aa77").trim,h="Number",m=n[h],p=m,g=m.prototype,b=a(i("2aeb")(g))==h,v="trim"in String.prototype,I=function(t){var e=o(t,!1);if("string"==typeof e&&e.length>2){e=v?e.trim():f(e,3);var i,n,r,a=e.charCodeAt(0);if(43===a||45===a){if(i=e.charCodeAt(2),88===i||120===i)return NaN}else if(48===a){switch(e.charCodeAt(1)){case 66:case 98:n=2,r=49;break;case 79:case 111:n=8,r=55;break;default:return+e}for(var s,c=e.slice(2),l=0,u=c.length;l<u;l++)if(s=c.charCodeAt(l),s<48||s>r)return NaN;return parseInt(c,n)}}return+e};if(!m(" 0o1")||!m("0b1")||m("+0x1")){m=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof m&&(b?c(function(){g.valueOf.call(i)}):a(i)!=h)?s(new p(I(e)),i,m):I(e)};for(var P,w=i("9e1e")?l(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),y=0;w.length>y;y++)r(p,P=w[y])&&!r(m,P)&&d(m,P,u(p,P));m.prototype=g,g.constructor=m,i("2aba")(n,h,m)}},d684:function(t,e,i){},e37e:function(t,e,i){"use strict";i.d(e,"d",function(){return r}),i.d(e,"c",function(){return a}),i.d(e,"b",function(){return s}),i.d(e,"a",function(){return o});var n=i("b775");function r(){return Object(n["a"])({url:"/sys/permissionsGroup",method:"get"})}function a(t){return Object(n["a"])({url:"/sys/permissions",method:"get",params:t})}function s(t){return Object(n["a"])({url:"/sys/editPermission",method:"post",data:t})}function o(t){return Object(n["a"])({url:"/sys/deletePermission",method:"post",data:t})}},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);