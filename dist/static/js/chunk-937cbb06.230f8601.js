(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-937cbb06","chunk-00468191"],{"0187":function(t,e,r){"use strict";r.d(e,"d",function(){return i}),r.d(e,"b",function(){return n}),r.d(e,"a",function(){return o}),r.d(e,"c",function(){return s}),r.d(e,"e",function(){return l});var a=r("b775");function i(t){return Object(a["a"])({url:"/sys/roles",method:"get",params:t})}function n(t){return Object(a["a"])({url:"/sys/editRole",method:"post",data:t})}function o(t){return Object(a["a"])({url:"/sys/deleteRole",method:"post",data:t})}function s(t){return Object(a["a"])({url:"/sys/getPermissionByRoleId",method:"get",params:{roleId:t}})}function l(t,e,r){return Object(a["a"])({url:"/sys/grantPermissions",method:"post",data:{roleId:t,addPermissionIds:e,deletePermissionIds:r}})}},"0a49":function(t,e,r){var a=r("9b43"),i=r("626a"),n=r("4bf8"),o=r("9def"),s=r("cd1c");t.exports=function(t,e){var r=1==t,l=2==t,c=3==t,u=4==t,d=6==t,f=5==t||d,m=e||s;return function(e,s,p){for(var h,v,b=n(e),g=i(b),y=a(s,p,3),w=o(g.length),_=0,x=r?m(e,w):l?m(e,0):void 0;w>_;_++)if((f||_ in g)&&(h=g[_],v=y(h,_,b),t))if(r)x[_]=v;else if(v)switch(t){case 3:return!0;case 5:return h;case 6:return _;case 2:x.push(h)}else if(u)return!1;return d?-1:c||u?u:x}}},"1b6a":function(t,e,r){"use strict";var a=r("4a55"),i=r.n(a);i.a},"4a55":function(t,e,r){},7514:function(t,e,r){"use strict";var a=r("5ca1"),i=r("0a49")(5),n="find",o=!0;n in[]&&Array(1)[n](function(){o=!1}),a(a.P+a.F*o,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r("9c6c")(n)},"9cf6":function(t,e,r){},aa77:function(t,e,r){var a=r("5ca1"),i=r("be13"),n=r("79e5"),o=r("fdef"),s="["+o+"]",l="​",c=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),d=function(t,e,r){var i={},s=n(function(){return!!o[t]()||l[t]()!=l}),c=i[t]=s?e(f):o[t];r&&(i[r]=c),a(a.P+a.F*s,"String",i)},f=d.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(u,"")),t};t.exports=d},c5f6:function(t,e,r){"use strict";var a=r("7726"),i=r("69a8"),n=r("2d95"),o=r("5dbc"),s=r("6a99"),l=r("79e5"),c=r("9093").f,u=r("11e9").f,d=r("86cc").f,f=r("aa77").trim,m="Number",p=a[m],h=p,v=p.prototype,b=n(r("2aeb")(v))==m,g="trim"in String.prototype,y=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){e=g?e.trim():f(e,3);var r,a,i,n=e.charCodeAt(0);if(43===n||45===n){if(r=e.charCodeAt(2),88===r||120===r)return NaN}else if(48===n){switch(e.charCodeAt(1)){case 66:case 98:a=2,i=49;break;case 79:case 111:a=8,i=55;break;default:return+e}for(var o,l=e.slice(2),c=0,u=l.length;c<u;c++)if(o=l.charCodeAt(c),o<48||o>i)return NaN;return parseInt(l,a)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,r=this;return r instanceof p&&(b?l(function(){v.valueOf.call(r)}):n(r)!=m)?o(new h(y(e)),r,p):y(e)};for(var w,_=r("9e1e")?c(h):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;_.length>x;x++)i(h,w=_[x])&&!i(p,w)&&d(p,w,u(h,w));p.prototype=v,v.constructor=p,r("2aba")(a,m,p)}},cd1c:function(t,e,r){var a=r("e853");t.exports=function(t,e){return new(a(t))(e)}},d869:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-container"},[r("el-row",{staticStyle:{width:"100%"}},[r("el-col",{attrs:{span:24}},[r("el-card",{attrs:{shadow:"hover"}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("span",[t._v("\n            当前选择用户：\n            "),r("label",[t._v(t._s(t.userName))])])]),t._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:t.roleData,"max-height":"650px",border:"",fit:"","header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"},"highlight-current-row":""}},[r("el-table-column",{attrs:{label:"角色名","min-width":"120",prop:"name"}}),t._v(" "),r("el-table-column",{attrs:{label:"备注","min-width":"80",prop:"remark"}}),t._v(" "),r("el-table-column",{attrs:{label:"操作",fixed:"right","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.grant?r("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(r){return t.revokeRole(e.row)}}},[t._v("回收")]):r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){return t.grantRole(e.row)}}},[t._v("授权")])]}}])})],1)],1)],1)],1)],1)},i=[],n=(r("7514"),r("ac6a"),r("c5f6"),r("0187")),o=r("8930"),s={data:function(){return{roleData:[],loading:!1,waitRoleData:!1,waitUserRole:!1,waitGrant:!1,existRole:[],selectedRole:[]}},created:function(){this.getRoleData()},computed:{listLoading:function(){return this.waitRoleData||this.waitUserRole||this.waitGrant}},props:{userId:Number,userName:String},watch:{userId:function(t,e){t&&this.loadRoleByUserId()}},methods:{getRoleData:function(){var t=this,e={currentPage:1,size:100};this.waitRoleData=!0,Object(n["d"])(e).then(function(e){var r=e.data.data.records;t.roleData=r,t.waitRoleData=!1,t.handleExistRole()}).catch()},loadRoleByUserId:function(){var t=this;this.waitUserRole=!0,Object(o["d"])(this.userId).then(function(e){var r=e.data.data;t.existRole=r,t.waitUserRole=!1,t.handleExistRole()})},handleExistRole:function(){var t=this;this.waitRoleData||this.waitUserRole||this.roleData.forEach(function(e){e.grant=!1;var r=t.existRole.some(function(t){return e.id==t.roleId});r&&(e.grant=!0)})},grantRole:function(t){var e=this,r={userId:this.userId,roleId:t.id};this.waitGrant=!0,Object(o["f"])(r).then(function(t){var r=t.data.data;r?(e.loadRoleByUserId(),e.$notify({title:"成功",message:"授权成功",type:"success",duration:2e3})):e.$notify({title:"失败",message:"授权失败",type:"success"}),e.waitGrant=!1})},revokeRole:function(t){var e=this,r=this.existRole.find(function(e){return e.roleId==t.id});this.waitGrant=!0,Object(o["g"])(r).then(function(r){var a=r.data.data;a?(t.grant=!1,e.$notify({title:"成功",message:"回收成功",type:"success",duration:2e3})):e.$notify({title:"失败",message:"回收失败",type:"success"}),e.waitGrant=!1})}}},l=s,c=(r("fdf3"),r("2877")),u=Object(c["a"])(l,a,i,!1,null,"0aa4527d",null);e["default"]=u.exports},e378:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-container"},[r("el-button",{attrs:{type:"primary"},on:{click:t.addUser}},[t._v("新增")]),t._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:t.listLoading,expression:"listLoading",modifiers:{body:!0}}],staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.userList,"max-height":"650px",border:"",fit:"","header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"},"highlight-current-row":""}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[r("el-form-item",{attrs:{label:"手机号"}},[r("span",[t._v(t._s(e.row.phone))])]),t._v(" "),r("el-form-item",{attrs:{label:"邮箱"}},[r("span",[t._v(t._s(e.row.email))])])],1)]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"帐号","min-width":"120",prop:"account"}}),t._v(" "),r("el-table-column",{attrs:{label:"姓名","min-width":"80",prop:"username"}}),t._v(" "),r("el-table-column",{attrs:{label:"备注","min-width":"120",prop:"remark"}}),t._v(" "),r("el-table-column",{attrs:{label:"操作",fixed:"right","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){return t.grantRole(e.row)}}},[t._v("分配角色")]),t._v(" "),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){return t.editUser(e.row)}}},[t._v("编辑")]),t._v(" "),r("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(r){return t.deleteUser(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),r("el-dialog",{attrs:{title:t.title,visible:t.editDialogVisible,center:"",width:"40%"},on:{"update:visible":function(e){t.editDialogVisible=e},close:t.resetForm}},[r("el-form",{directives:[{name:"loading",rawName:"v-loading.body",value:t.detailLoading,expression:"detailLoading",modifiers:{body:!0}}],ref:"form",attrs:{model:t.form,"label-width":"80px"}},[r("el-form-item",{staticStyle:{width:"47%"},attrs:{label:"帐号",prop:"account"}},[r("el-input",{attrs:{placeholder:"请输入帐号名"},model:{value:t.form.account,callback:function(e){t.$set(t.form,"account","string"===typeof e?e.trim():e)},expression:"form.account"}})],1),t._v(" "),r("el-form-item",{staticStyle:{width:"47%"},attrs:{label:"姓名",prop:"username"}},[r("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username","string"===typeof e?e.trim():e)},expression:"form.username"}})],1),t._v(" "),r("el-form-item",{staticStyle:{width:"47%"},attrs:{label:"手机号",prop:"phone"}},[r("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone","string"===typeof e?e.trim():e)},expression:"form.phone"}})],1),t._v(" "),r("el-form-item",{staticStyle:{width:"47%"},attrs:{label:"邮箱",prop:"email"}},[r("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email","string"===typeof e?e.trim():e)},expression:"form.email"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{placeholder:"请输入密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password","string"===typeof e?e.trim():e)},expression:"form.password"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"备注",prop:"remark"}},[r("el-input",{attrs:{placeholder:"请输入备注"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark","string"===typeof e?e.trim():e)},expression:"form.remark"}})],1),t._v(" "),"编辑"==t.title?r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(){return t.saveOrUpdateUser()}}},[t._v("更新")]),t._v(" "),r("el-button",{on:{click:function(){return t.cancel()}}},[t._v("取消")])],1):t._e(),t._v(" "),"新增"==t.title?r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(){return t.saveOrUpdateUser()}}},[t._v("保存")]),t._v(" "),r("el-button",{on:{click:function(){return t.cancel()}}},[t._v("取消")])],1):t._e()],1)],1),t._v(" "),r("el-dialog",{attrs:{title:"分配当前角色权限",visible:t.userDialogVisible,center:""},on:{"update:visible":function(e){t.userDialogVisible=e}}},[r("grant-role",{attrs:{userId:t.currentUserId,userName:t.currentUserName}})],1)],1)},i=[],n=r("8930"),o=r("d869"),s={components:{grantRole:o["default"]},data:function(){return{userList:[],listLoading:!1,detailLoading:!1,editDialogVisible:!1,userDialogVisible:!1,title:"",formModel:{account:void 0,username:void 0,password:void 0,phone:void 0,email:void 0,remark:void 0},form:{},currentUserId:void 0,currentUserName:void 0}},created:function(){this.loadUsers(),this.resetForm()},watch:{},methods:{loadUsers:function(){var t=this,e={currentPage:1,size:100};this.listLoading=!0,Object(n["e"])(e).then(function(e){var r=e.data.data.records;t.userList=r,t.listLoading=!1}).catch()},resetForm:function(){this.form=JSON.parse(JSON.stringify(this.formModel))},addUser:function(){this.editDialogVisible=!0,this.title="新增"},editUser:function(t){this.editDialogVisible=!0,this.title="编辑",this.form=JSON.parse(JSON.stringify(t))},saveOrUpdateUser:function(){var t=this;this.detailLoading=!0,Object(n["b"])(this.form).then(function(e){t.$notify({title:"成功",message:"编辑成功",type:"success",duration:2e3}),t.detailLoading=!1,t.editDialogVisible=!1,t.loadUsers()}).catch(function(e){t.$notify({title:"失败",message:"编辑失败",type:"error"}),t.detailLoading=!1})},deleteUser:function(t){var e=this;this.listLoading=!0,Object(n["a"])(t.id).then(function(t){var r=t.data.data;r?(e.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3}),e.listLoading=!1,e.loadUsers()):e.$notify({title:"失败",message:"删除失败",type:"error"})})},cancel:function(){this.editDialogVisible=!1},grantRole:function(t){var e=this;this.userDialogVisible=!0,this.$nextTick(function(){e.currentUserId=t.id,e.currentUserName=t.username})}}},l=s,c=(r("1b6a"),r("2877")),u=Object(c["a"])(l,a,i,!1,null,null,null);e["default"]=u.exports},e853:function(t,e,r){var a=r("d3f4"),i=r("1169"),n=r("2b4c")("species");t.exports=function(t){var e;return i(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!i(e.prototype)||(e=void 0),a(e)&&(e=e[n],null===e&&(e=void 0))),void 0===e?Array:e}},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},fdf3:function(t,e,r){"use strict";var a=r("9cf6"),i=r.n(a);i.a}}]);