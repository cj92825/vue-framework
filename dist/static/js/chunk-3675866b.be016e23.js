(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3675866b"],{"1ed2":function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("el-row",{staticStyle:{width:"100%"}},[i("el-col",{attrs:{span:7}},[i("el-card",{attrs:{shadow:"hover"}},[i("div",{attrs:{slot:"header"},slot:"header"},[i("el-input",{attrs:{placeholder:"输入关键字过滤"},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}})],1),t._v(" "),i("el-scrollbar",[i("el-tree",{directives:[{name:"loading",rawName:"v-loading.body",value:t.loading,expression:"loading",modifiers:{body:!0}}],ref:"tree",staticStyle:{height:"620px"},attrs:{data:t.treeData,"default-expand-all":"","node-key":"id","highlight-current":"","expand-on-click-node":!1,"filter-node-method":t.filterNode},on:{"node-click":t.handleNodeClick},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.node,n=e.data;return i("span",{staticClass:"custom-tree-node"},[i("span",[t._v(t._s(r.label))]),t._v(" "),i("span",[i("el-tooltip",{attrs:{content:"新增"}},[i("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-plus"},on:{click:function(e){return e.stopPropagation(),t.handlerTreeAdd(n)}}})],1),t._v(" "),i("el-tooltip",{attrs:{content:"编辑"}},[i("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit-outline"},on:{click:function(e){return e.stopPropagation(),t.handlerTreeEdit(n)}}})],1),t._v(" "),0!=n.parentId?i("el-tooltip",{attrs:{content:"删除"}},[i("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(e){return e.stopPropagation(),t.handlerTreeDelete(n)}}})],1):t._e()],1)])}}])})],1)],1)],1),t._v(" "),i("el-col",{attrs:{span:17}},[i("el-card",{attrs:{shadow:"hover"}},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.addPermission()}}},[t._v("新增")]),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:t.listLoading,expression:"listLoading",modifiers:{body:!0}}],staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.filterPermissionData,"max-height":"650px",border:"",fit:"","header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"},"highlight-current-row":""}},[i("el-table-column",{attrs:{type:"index",width:"50"}}),t._v(" "),i("el-table-column",{attrs:{label:"请求地址","min-width":"120",prop:"uri"}}),t._v(" "),i("el-table-column",{attrs:{label:"资源名","min-width":"80",prop:"name"}}),t._v(" "),i("el-table-column",{attrs:{label:"描述","min-width":"120",prop:"description"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",fixed:"right","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(i){return t.editPermission(e.row)}}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(i){return t.deletePermission(e.row)}}},[t._v("删除")])]}}])})],1)],1)],1)],1),t._v(" "),i("el-dialog",{attrs:{title:t.title,visible:t.editDialogVisible,center:"",width:"40%"},on:{"update:visible":function(e){t.editDialogVisible=e},close:t.resetForm}},[i("el-form",{directives:[{name:"loading",rawName:"v-loading.body",value:t.detailLoading,expression:"detailLoading",modifiers:{body:!0}}],ref:"form",attrs:{model:t.form,"label-width":"80px"}},[i("el-form-item",{staticStyle:{width:"47%"},attrs:{label:"资源名",prop:"name"}},[i("el-input",{attrs:{placeholder:"请输入资源名"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name","string"===typeof e?e.trim():e)},expression:"form.name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"请求地址",prop:"uri"}},[i("el-input",{attrs:{placeholder:"请输入请求地址"},model:{value:t.form.uri,callback:function(e){t.$set(t.form,"uri","string"===typeof e?e.trim():e)},expression:"form.uri"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"描述",prop:"description"}},[i("el-input",{attrs:{placeholder:"请输入描述"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description","string"===typeof e?e.trim():e)},expression:"form.description"}})],1),t._v(" "),"编辑"==t.title?i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(){return t.saveOrUpdatePermission()}}},[t._v("更新")]),t._v(" "),i("el-button",{on:{click:function(){return t.cancel()}}},[t._v("取消")])],1):t._e(),t._v(" "),"新增"==t.title?i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(){return t.saveOrUpdatePermission()}}},[t._v("保存")]),t._v(" "),i("el-button",{on:{click:function(){return t.cancel()}}},[t._v("取消")])],1):t._e()],1)],1)],1)},n=[],o=(i("ac6a"),i("e37e")),a={data:function(){return{filterText:"",treeData:[],permissionData:[],filterPermissionData:[],loading:!1,listLoading:!1,detailLoading:!1,editDialogVisible:!1,title:"",currentGroupId:1,formModel:{description:void 0,name:void 0,uri:void 0},form:{}}},created:function(){this.getGroup(),this.getPermissionData(),this.resetForm()},watch:{filterText:function(t){this.$refs.tree.filter(t)}},methods:{getGroup:function(){var t=this;this.loading=!0,Object(o["d"])().then(function(e){var i=e.data.data;t.formatTree(i),t.loading=!1}).catch()},getPermissionData:function(){var t=this,e={currentPage:1,size:100};this.listLoading=!0,Object(o["c"])(e).then(function(e){var i=e.data.data.records;t.permissionData=i,t.filterTableData(),t.listLoading=!1}).catch()},filterNode:function(t,e){return!t||-1!==e.label.indexOf(t)},formatTree:function(t){var e=this;t.forEach(function(i){0==i.parentId?e.treeData.push(i):t.forEach(function(t){t.id==i.parentId&&(t.children||(t.children=[]),t.children.push(i))})})},handleNodeClick:function(t){this.currentGroupId=t.id,this.filterTableData()},filterTableData:function(){var t=this;this.filterPermissionData=this.permissionData.filter(function(e){return 1==t.currentGroupId||e.groupId==t.currentGroupId})},addPermission:function(){this.editDialogVisible=!0,this.title="新增",this.form.groupId=this.currentGroupId},editPermission:function(t){this.editDialogVisible=!0,this.title="编辑",this.form=JSON.parse(JSON.stringify(t)),console.log(JSON.stringify(this.form)),this.form.groupId=this.currentGroupId},saveOrUpdatePermission:function(){var t=this;this.detailLoading=!0,Object(o["b"])(this.form).then(function(e){var i=e.data.data;i?(t.$notify({title:"成功",message:"编辑成功",type:"success",duration:2e3}),t.detailLoading=!1,t.editDialogVisible=!1,t.getPermissionData()):t.$notify({title:"失败",message:"编辑失败",type:"error"})})},cancel:function(){this.editDialogVisible=!1},resetForm:function(){this.form=JSON.parse(JSON.stringify(this.formModel))},deletePermission:function(t){var e=this;this.listLoading=!0,Object(o["a"])(t.id).then(function(t){var i=t.data.data;i?(e.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3}),e.listLoading=!1,e.getPermissionData()):e.$notify({title:"失败",message:"删除失败",type:"error"})})},handlerTreeAdd:function(t){},handlerTreeEdit:function(t){},handlerTreeDelete:function(t){}}},l=a,s=(i("287b"),i("2877")),c=Object(s["a"])(l,r,n,!1,null,"e0008634",null);e["default"]=c.exports},"287b":function(t,e,i){"use strict";var r=i("f7c4"),n=i.n(r);n.a},e37e:function(t,e,i){"use strict";i.d(e,"d",function(){return n}),i.d(e,"c",function(){return o}),i.d(e,"b",function(){return a}),i.d(e,"a",function(){return l});var r=i("b775");function n(){return Object(r["a"])({url:"/sys/permissionsGroup",method:"get"})}function o(t){return Object(r["a"])({url:"/sys/permissions",method:"get",params:t})}function a(t){return Object(r["a"])({url:"/sys/editPermission",method:"post",data:t})}function l(t){return Object(r["a"])({url:"/sys/deletePermission",method:"post",data:t})}},f7c4:function(t,e,i){}}]);